<!-- Test simulation of model with structured populations -->

<beast version='2.0' namespace='viralPopGen.beast:beast.core.parameter'>
       <run spec='StochasticSimulation'
		simulationTime='20'
		nTimeSteps='1001'
		nSamples='1001'
		nTraj='100'
		seed='53'
		outFileName='out.txt'>

		<model spec='Model' id='model'>
			<population spec='Population' id='X' popName='X'>
				<dim spec='IntegerParameter'>2</dim>
			</population>

			<reaction spec='Reaction'>
				<rate spec='RealParameter'>0.2</rate>
				<rate spec='RealParameter'>0.1</rate>
				<reactantSchema spec='Schema'>
					<popSchema spec='PopSchema'>
						<population idref='X'/>
					</popSchema>
					<subPopSchema spec='SubPopSchema'>
						<subPopulation spec='SubPopulation' id='demeA'>
							<location spec='IntegerParameter'>0</location>
						</subPopulation>
					</subPopSchema>
					<subPopSchema spec='SubPopSchema'>
						<subPopulation spec='SubPopulation' id='demeB'>
							<location spec='IntegerParameter'>1</location>
						</subPopulation>
					</subPopSchema>
				</reactantSchema>
				<productSchema spec='Schema'>
					<popSchema spec='PopSchema'>
						<population idref='X'/>
					</popSchema>
					<subPopSchema spec='SubPopSchema'>
						<subPopulation idref='demeB'/>
					</subPopSchema>
					<subPopSchema spec='SubPopSchema'>
						<subPopulation idref='demeA'/>
					</subPopSchema>
				</productSchema>
			</reaction>
		</model>

		<initialState spec='InitState'>
			<populationSize spec='PopulationSize' size='100'>
				<population idref='X'/>
				<subPopulation idref='demeA'/>
			</populationSize>
			<model idref='model'/>
		</initialState>

		<moment spec='viralPopGen.beast.Moment' momentName='X'>
			<momentSchema spec='Schema'>
				<popSchema spec='PopSchema'>
					<population idref='X'/>
				</popSchema>
				<subPopSchema spec='SubPopSchema'>
					<subPopulation idref='demeA'/>
				</subPopSchema>
				<subPopSchema spec='SubPopSchema'>
					<subPopulation idref='demeB'/>
				</subPopSchema>
			</momentSchema>
		</moment>
	</run>
</beast>
