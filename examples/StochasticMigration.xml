<!-- Test simulation of model with structured populations -->

<beast version='2.0'>
       <run spec='viralPopGen.beast.StochasticSimulation'
		simulationTime='20'
		nTimeSteps='1001'
		nSamples='1001'
		nTraj="1"
		seed="53"
		outFileName="out.txt">

		<model spec='viralPopGen.beast.Model' id="model">
			<population spec='viralPopGen.beast.Population' id="X" popName="X">
				<dim>2</dim>
			</population>

			<reaction spec="viralPopGen.beast.Reaction" rate="0.1">
				<reactantSchema spec="viralPopGen.beast.Schema">
					<popSchema spec="viralPopGen.beast.PopSchema">
						<population idref="X"/>
					</popSchema>
					<subPopSchema spec="viralPopGen.beast.SubPopSchema">
						<subPopulation spec="viralPopGen.beast.SubPopulation" id="demeA">
							<location>0</location>
						</subPopulation>
					</subPopSchema>
					<subPopSchema spec="viralPopGen.beast.SubPopSchema">
						<subPopulation spec="viralPopGen.beast.SubPopulation" id="demeB">
							<location>1</location>
						</subPopulation>
					</subPopSchema>
				</reactantSchema>
				<productSchema spec="viralPopGen.beast.Schema">
					<popSchema spec="viralPopGen.beast.PopSchema">
						<population idref="X"/>
					</popSchema>
					<subPopSchema spec="viralPopGen.beast.SubPopSchema">
						<subPopulation idref="demeB"/>
					</subPopSchema>
					<subPopSchema>
						<subPopulation idref="demeA"/>
					</subPopSchema>
				</productSchema>
			</reaction>

			<moment spec="viralPopGen.beast.Moment" name="X">
				<momentSchema spec="viralPopGen.beast.Schema">
					<popSchema spec="viralPopGen.beast.PopSchema">
						<population idref="X"/>
					</popSchema>
					<subPopSchema spec="viralPopGen.beast.SubPopSchema">
						<subPopulation idref="demeA"/>
					</subPopSchema>
					<subPopSchema spec="viralPopGen.beast.SubPopSchema">
						<subPopulation idref="demeB"/>
					</subPopSchema>
				</momentSchema>
			</moment>

		</model>

		<initialState spec="viralPopGen.beast.InitState">
			<populationSize spec="viralPopGen.beast.PopulationSize" size="100">
				<population idref="X"/>
				<subPopulation idref="demeA"/>
			</populationSize>
			<model idref="model"/>
		</initialState>

	</run>
</beast>
